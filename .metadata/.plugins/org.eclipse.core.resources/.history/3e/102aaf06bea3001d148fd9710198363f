package core.support;

import junit.framework.Assert;

public class Timer {
	private long timeout;
	private long currentTime;

	public Timer(long timeout) {
		this.timeout = timeout;
		this.currentTime = System.currentTimeMillis();
	}

	public void waitUtil(Condition condition) {
		while (System.currentTimeMillis() < currenttime + timeout) {
			if (condition.isSatisfied()) {
				return;
			} else {
				waitAbit(500);
				System.out.println("waiting a bit...." + condition.describe());
			}
			Assert.fail("Could not satisfy the condition: " + condition.describe());
		}
	}
	
	private void waitAbit(long wait) {
		try {
			Thread.sleep(wait);
		} catch (InterruptedException e) {
			e.printStackTrace();
		}
	}
}
